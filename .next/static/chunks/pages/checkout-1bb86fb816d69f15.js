(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[222],{7250:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout",function(){return n(6275)}])},6275:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var s=n(5893),c=n(7294),a=n(6664),r=n(4465),i=n(5675),u=n.n(i);function l(){let e=(0,a.useStripe)(),t=(0,a.useElements)(),[n,r]=(0,c.useState)(null),[i,u]=(0,c.useState)(!1),l=async n=>{if(n.preventDefault(),!e||!t)return;u(!0);let{error:s}=await e.confirmPayment({elements:t,confirmParams:{return_url:window.location.origin+"/checkout?status=success"}});s&&r(s.message||"An unexpected error occurred."),u(!1)};return(0,s.jsxs)("form",{onSubmit:l,className:"space-y-4",children:[(0,s.jsx)(a.PaymentElement,{}),(0,s.jsx)("button",{type:"submit",disabled:!e||i,className:"px-4 py-2 bg-green-600 text-white rounded disabled:opacity-50",children:i?"Processing…":"Pay now"}),n&&(0,s.jsx)("div",{className:"text-red-500",children:n})]})}var o=n(7216),d=n(3454);let m=(0,r.J)(d.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY||"");function h(){let[e,t]=(0,c.useState)(""),[n,r]=(0,c.useState)(null);return((0,c.useEffect)(()=>{let e=new URLSearchParams(window.location.search),n=e.get("slug")||"",s=e.get("qty")||"1";r(o.find(e=>e.slug===n&&e.active)||null),n&&fetch("/api/stripe/create-intent?slug=".concat(n,"&qty=").concat(s)).then(e=>e.json()).then(e=>t(e.clientSecret))},[]),n)?(0,s.jsxs)("div",{className:"p-8 max-w-md mx-auto",children:[(0,s.jsxs)("h1",{className:"text-xl font-semibold mb-4",children:["Checkout — ",n.title]}),(0,s.jsx)(u(),{src:n.images[0]||"/placeholder-product.png",alt:n.title,width:400,height:400,className:"mb-4"}),e&&(0,s.jsx)(a.Elements,{stripe:m,options:{clientSecret:e},children:(0,s.jsx)(l,{})})]}):(0,s.jsx)("p",{className:"p-4",children:"Product not found."})}}},function(e){e.O(0,[675,564,216,888,774,179],function(){return e(e.s=7250)}),_N_E=e.O()}]);